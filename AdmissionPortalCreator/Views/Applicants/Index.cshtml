@model List<AdmissionPortalCreator.Models.FormSubmission>
@{
    ViewData["Title"] = "Applicants";
    var form = ViewBag.Form as AdmissionPortalCreator.Models.Form;
}

<div class="container-fluid">
    <div class="row">
        <div class="col-12">
            <!-- Header -->
            <div class="d-flex justify-content-between align-items-center mb-4 flex-wrap gap-3">
                <div>
                    <h3 class="mb-1 text-dark fw-bold">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-people-fill me-2" viewBox="0 0 16 16">
                            <path d="M7 14s-1 0-1-1 1-4 5-4 5 3 5 4-1 1-1 1H7zm4-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6z" />
                            <path fill-rule="evenodd" d="M5.216 14A2.238 2.238 0 0 1 5 13c0-1.355.68-2.75 1.936-3.72A6.325 6.325 0 0 0 5 9c-4 0-5 3-5 4s1 1 1 1h4.216z" />
                            <path d="M4.5 8a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5z" />
                        </svg>
                        Applicants: @form.Name
                    </h3>
                    <p class="text-muted mb-0 small">
                        <span class="badge bg-light text-dark border me-2">@Model.Count Total Submissions</span>
                        <span class="text-muted">@form.StartDate.ToString("MMM dd, yyyy") - @form.EndDate.ToString("MMM dd, yyyy")</span>
                    </p>
                </div>
                <div class="d-flex gap-2">
                    <a asp-action="ExportCSV" asp-route-formId="@form.FormId" class="btn btn-outline-secondary">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download me-1" viewBox="0 0 16 16">
                            <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z" />
                            <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z" />
                        </svg>
                        Export CSV
                    </a>
                    <a asp-controller="Home" asp-action="Index" class="btn btn-dark">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-left me-1" viewBox="0 0 16 16">
                            <path fill-rule="evenodd" d="M15 8a.5.5 0 0 0-.5-.5H2.707l3.147-3.146a.5.5 0 1 0-.708-.708l-4 4a.5.5 0 0 0 0 .708l4 4a.5.5 0 0 0 .708-.708L2.707 8.5H14.5A.5.5 0 0 0 15 8z" />
                        </svg>
                        Back
                    </a>
                </div>
            </div>

            <!-- Content -->
            @if (Model.Any())
            {
                <div class="card border-0 shadow-sm">
                    <div class="card-body p-0">
                        <div class="table-responsive">
                            <table class="table table-hover mb-0">
                                <thead class="bg-white border-bottom">
                                    <tr>
                                        <th class="px-4 py-3 text-muted fw-semibold">ID</th>
                                        <th class="px-4 py-3 text-muted fw-semibold">Applicant Name</th>
                                        <th class="px-4 py-3 text-muted fw-semibold">Email</th>
                                        <th class="px-4 py-3 text-muted fw-semibold">Phone</th>
                                        <th class="px-4 py-3 text-muted fw-semibold">Submitted On</th>
                                        <th class="px-4 py-3 text-muted fw-semibold text-end">Actions</th>
                                    </tr>
                                </thead>
                                <tbody class="bg-white">
                                    @foreach (var submission in Model)
                                    {
                                        <tr>
                                            <td class="px-4 py-3">
                                                <span class="badge bg-light text-dark border">#@submission.SubmissionId</span>
                                            </td>
                                            <td class="px-4 py-3">
                                                <div class="d-flex align-items-center">
                                                    <div class="bg-secondary text-white rounded-circle d-flex align-items-center justify-content-center me-2" style="width: 32px; height: 32px; font-size: 14px;">
                                                        @((submission.User.FullName ?? submission.User.UserName)?.Substring(0, 1).ToUpper())
                                                    </div>
                                                    <strong>@(submission.User.FullName ?? submission.User.UserName)</strong>
                                                </div>
                                            </td>
                                            <td class="px-4 py-3 text-muted">@submission.User.Email</td>
                                            <td class="px-4 py-3 text-muted">@(submission.User.PhoneNumber ?? "N/A")</td>
                                            <td class="px-4 py-3 text-muted">@submission.SubmittedAt.ToString("MMM dd, yyyy hh:mm tt")</td>
                                            <td class="px-4 py-3 text-end">
                                                <a asp-action="ViewSubmission"
                                                   asp-route-submissionId="@submission.SubmissionId"
                                                   class="btn btn-sm btn-dark">
                                                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" class="bi bi-eye me-1" viewBox="0 0 16 16">
                                                        <path d="M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8zM1.173 8a13.133 13.133 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5c2.12 0 3.879 1.168 5.168 2.457A13.133 13.133 0 0 1 14.828 8c-.058.087-.122.183-.195.288-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5c-2.12 0-3.879-1.168-5.168-2.457A13.134 13.134 0 0 1 1.172 8z" />
                                                        <path d="M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5zM4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0z" />
                                                    </svg>
                                                    View
                                                </a>
                                            </td>
                                        </tr>
                                    }
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            }
            else
            {
                <div class="card border-0 shadow-sm">
                    <div class="card-body text-center py-5">
                        <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="currentColor" class="bi bi-inbox text-muted mb-3" viewBox="0 0 16 16">
                            <path d="M4.98 4a.5.5 0 0 0-.39.188L1.54 8H6a.5.5 0 0 1 .5.5 1.5 1.5 0 1 0 3 0A.5.5 0 0 1 10 8h4.46l-3.05-3.812A.5.5 0 0 0 11.02 4H4.98zm9.954 5H10.45a2.5 2.5 0 0 1-4.9 0H1.066l.32 2.562a.5.5 0 0 0 .497.438h12.234a.5.5 0 0 0 .496-.438L14.933 9zM3.809 3.563A1.5 1.5 0 0 1 4.981 3h6.038a1.5 1.5 0 0 1 1.172.563l3.7 4.625a.5.5 0 0 1 .105.374l-.39 3.124A1.5 1.5 0 0 1 14.117 13H1.883a1.5 1.5 0 0 1-1.489-1.314l-.39-3.124a.5.5 0 0 1 .106-.374l3.7-4.625z" />
                        </svg>
                        <h5 class="text-muted mb-2">No applications yet</h5>
                        <p class="text-muted">No one has submitted an application for this form yet.</p>
                    </div>
                </div>
            }
        </div>
    </div>
</div>